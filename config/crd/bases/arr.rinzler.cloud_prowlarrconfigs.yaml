---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  name: prowlarrconfigs.arr.rinzler.cloud
spec:
  group: arr.rinzler.cloud
  names:
    kind: ProwlarrConfig
    listKind: ProwlarrConfigList
    plural: prowlarrconfigs
    singular: prowlarrconfig
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.connection.url
      name: URL
      type: string
    - jsonPath: .status.managedIndexers
      name: Indexers
      type: integer
    - jsonPath: .status.conditions[?(@.type=="Ready")].status
      name: Ready
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: ProwlarrConfig is the all-in-one configuration for a Prowlarr
          instance
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: Spec defines the desired configuration for Prowlarr.
            properties:
              applications:
                description: |-
                  Applications configures sync to Radarr/Sonarr/Lidarr.
                  Usually not needed if those apps use prowlarrRef with autoRegister.
                items:
                  description: ProwlarrApplication defines sync to a downstream app
                  properties:
                    apiKeySecretRef:
                      description: |-
                        APIKeySecretRef for the application.
                        If not specified, auto-discovery is attempted.
                      properties:
                        key:
                          default: apiKey
                          description: Key is the key within the Secret.
                          type: string
                        name:
                          description: Name is the name of the Secret in the same
                            namespace.
                          type: string
                      required:
                      - name
                      type: object
                    configPath:
                      description: ConfigPath for API key auto-discovery.
                      type: string
                    name:
                      description: Name is the display name.
                      type: string
                    syncCategories:
                      description: |-
                        SyncCategories to sync (human-readable or numeric).
                        Defaults based on app type if not specified.
                      items:
                        type: string
                      type: array
                    syncLevel:
                      default: fullSync
                      description: 'SyncLevel: disabled, addOnly, fullSync'
                      enum:
                      - disabled
                      - addOnly
                      - fullSync
                      type: string
                    type:
                      description: 'Type: radarr, sonarr, lidarr'
                      enum:
                      - radarr
                      - sonarr
                      - lidarr
                      type: string
                    url:
                      description: URL is the application URL.
                      type: string
                  required:
                  - name
                  - type
                  - url
                  type: object
                type: array
              authentication:
                description: Authentication configures authentication settings.
                properties:
                  authenticationRequired:
                    default: enabled
                    description: AuthenticationRequired specifies when authentication
                      is required.
                    enum:
                    - enabled
                    - disabledForLocalAddresses
                    type: string
                  method:
                    default: none
                    description: Method is the authentication method.
                    enum:
                    - none
                    - forms
                    - external
                    type: string
                  passwordSecretRef:
                    description: PasswordSecretRef references the password Secret
                      for forms authentication.
                    properties:
                      key:
                        default: apiKey
                        description: Key is the key within the Secret.
                        type: string
                      name:
                        description: Name is the name of the Secret in the same namespace.
                        type: string
                    required:
                    - name
                    type: object
                  username:
                    description: Username for forms authentication.
                    type: string
                type: object
              connection:
                description: |-
                  Connection specifies how to connect to Prowlarr.
                  Note: Prowlarr uses API v1, not v3.
                properties:
                  apiKeySecretRef:
                    description: |-
                      APIKeySecretRef references a Secret containing the API key.
                      If not specified, auto-discovery is attempted.
                    properties:
                      key:
                        default: apiKey
                        description: Key is the key within the Secret.
                        type: string
                      name:
                        description: Name is the name of the Secret in the same namespace.
                        type: string
                    required:
                    - name
                    type: object
                  configPath:
                    description: |-
                      ConfigPath is the path to config.xml for API key auto-discovery.
                      Only used if APIKeySecretRef is not specified.
                      Defaults to /{app}-config/config.xml
                    type: string
                  insecureSkipVerify:
                    description: InsecureSkipVerify disables TLS certificate verification.
                    type: boolean
                  timeout:
                    default: 30s
                    description: Timeout specifies the connection timeout.
                    type: string
                  url:
                    description: URL is the base URL of the service (e.g., http://radarr:7878)
                    pattern: ^https?://
                    type: string
                required:
                - url
                type: object
              downloadClients:
                description: DownloadClients configures download clients in Prowlarr.
                items:
                  description: DownloadClientSpec defines a download client
                  properties:
                    category:
                      description: Category for downloads. Defaults to app name (e.g.,
                        "radarr").
                      type: string
                    credentialsSecretRef:
                      description: CredentialsSecretRef references username/password.
                      properties:
                        name:
                          description: Name is the name of the Secret.
                          type: string
                        passwordKey:
                          default: password
                          description: PasswordKey is the key for the password.
                          type: string
                        usernameKey:
                          default: username
                          description: UsernameKey is the key for the username.
                          type: string
                      required:
                      - name
                      type: object
                    enabled:
                      default: true
                      description: Enabled enables/disables this client.
                      type: boolean
                    name:
                      description: |-
                        Name is the display name for this client.
                        Also used for type inference if Type is not specified.
                      type: string
                    priority:
                      default: 50
                      description: Priority affects client selection (higher = preferred).
                      maximum: 100
                      minimum: 1
                      type: integer
                    type:
                      description: Type is the client type. If not specified, inferred
                        from Name.
                      enum:
                      - qbittorrent
                      - transmission
                      - deluge
                      - rtorrent
                      - nzbget
                      - sabnzbd
                      type: string
                    url:
                      description: URL is the client URL (e.g., http://qbittorrent:8080)
                      type: string
                  required:
                  - name
                  - url
                  type: object
                type: array
              indexers:
                description: Indexers configures native indexers in Prowlarr.
                items:
                  description: ProwlarrIndexer defines a native indexer in Prowlarr
                  properties:
                    apiKeySecretRef:
                      description: APIKeySecretRef for private indexers.
                      properties:
                        key:
                          default: apiKey
                          description: Key is the key within the Secret.
                          type: string
                        name:
                          description: Name is the name of the Secret in the same
                            namespace.
                          type: string
                      required:
                      - name
                      type: object
                    baseUrl:
                      description: BaseURL overrides the default URL for the indexer.
                      type: string
                    definition:
                      description: Definition is the indexer definition (e.g., "1337x",
                        "Nyaa", "IPTorrents").
                      type: string
                    enabled:
                      default: true
                      description: Enabled enables/disables this indexer.
                      type: boolean
                    name:
                      description: Name is the display name.
                      type: string
                    priority:
                      default: 25
                      description: Priority (1-50).
                      type: integer
                    settings:
                      additionalProperties:
                        type: string
                      description: Settings are definition-specific settings.
                      type: object
                    tags:
                      description: Tags associate this indexer with proxies.
                      items:
                        type: string
                      type: array
                  required:
                  - definition
                  - name
                  type: object
                type: array
              proxies:
                description: Proxies configures indexer proxies (e.g., FlareSolverr).
                items:
                  description: IndexerProxy defines a proxy for indexer requests
                  properties:
                    credentialsSecretRef:
                      description: CredentialsSecretRef for authenticated proxies.
                      properties:
                        name:
                          description: Name is the name of the Secret.
                          type: string
                        passwordKey:
                          default: password
                          description: PasswordKey is the key for the password.
                          type: string
                        usernameKey:
                          default: username
                          description: UsernameKey is the key for the username.
                          type: string
                      required:
                      - name
                      type: object
                    host:
                      description: |-
                        Host is the proxy URL or hostname.
                        For FlareSolverr: full URL (http://flaresolverr:8191)
                        For HTTP/SOCKS: hostname only
                      type: string
                    name:
                      description: Name is the display name.
                      type: string
                    port:
                      description: Port for HTTP/SOCKS proxies.
                      type: integer
                    requestTimeout:
                      default: 60
                      description: RequestTimeout for FlareSolverr (seconds).
                      type: integer
                    tags:
                      description: Tags to associate with indexers that should use
                        this proxy.
                      items:
                        type: string
                      type: array
                    type:
                      description: 'Type: flaresolverr, http, socks4, socks5'
                      enum:
                      - flaresolverr
                      - http
                      - socks4
                      - socks5
                      type: string
                  required:
                  - host
                  - name
                  - type
                  type: object
                type: array
              reconciliation:
                description: Reconciliation configures sync behavior.
                properties:
                  interval:
                    default: 5m
                    description: Interval between reconciliations.
                    type: string
                  suspend:
                    description: Suspend pauses reconciliation.
                    type: boolean
                type: object
            required:
            - connection
            type: object
          status:
            description: Status defines the observed state of ProwlarrConfig.
            properties:
              conditions:
                description: Conditions represent the latest observations of the ProwlarrConfig's
                  state.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              connected:
                description: Connected indicates whether Prowlarr is reachable.
                type: boolean
              health:
                description: Health represents the app's health status from its internal
                  health checks.
                properties:
                  errorCount:
                    description: ErrorCount is the number of error-level issues.
                    type: integer
                  healthy:
                    description: Healthy indicates whether the app has no error-level
                      issues.
                    type: boolean
                  issueCount:
                    description: IssueCount is the total number of health issues.
                    type: integer
                  issues:
                    description: Issues lists the current health issues.
                    items:
                      description: HealthIssueStatus represents a single health issue
                      properties:
                        message:
                          description: Message is the human-readable description.
                          type: string
                        source:
                          description: Source identifies the check that produced this
                            issue.
                          type: string
                        type:
                          description: 'Type is the severity: error, warning, notice.'
                          type: string
                        wikiUrl:
                          description: WikiURL is a link to documentation about this
                            issue.
                          type: string
                      type: object
                    type: array
                  lastCheck:
                    description: LastCheck is the timestamp of the last health check.
                    format: date-time
                    type: string
                  warningCount:
                    description: WarningCount is the number of warning-level issues.
                    type: integer
                type: object
              lastAppliedHash:
                description: LastAppliedHash is the hash of the last applied spec.
                type: string
              lastReconcile:
                description: LastReconcile is the timestamp of the last reconciliation.
                format: date-time
                type: string
              managedApplications:
                description: ManagedApplications lists managed application IDs.
                items:
                  type: integer
                type: array
              managedIndexers:
                description: ManagedIndexers lists managed indexer IDs.
                items:
                  type: integer
                type: array
              managedProxies:
                description: ManagedProxies lists managed proxy IDs.
                items:
                  type: integer
                type: array
              serviceVersion:
                description: ServiceVersion is the Prowlarr version.
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
