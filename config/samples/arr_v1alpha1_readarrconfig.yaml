apiVersion: arr.rinzler.cloud/v1alpha1
kind: ReadarrConfig
metadata:
  labels:
    app.kubernetes.io/name: nebularr
    app.kubernetes.io/managed-by: kustomize
  name: readarrconfig-sample
spec:
  # Connection to Readarr instance
  connection:
    url: http://readarr.media.svc.cluster.local:8787
    apiKeySecretRef:
      name: readarr-credentials
      key: apiKey

  # Quality profile settings for ebooks
  quality:
    preset: standard
    # Or use "high-quality" for preferred formats
    # Or "audiobook-focus" for audiobook-first selection

  # Metadata profile settings
  metadataProfile:
    name: Standard
    minPopularity: 0
    skipMissingDate: true
    skipMissingIsbn: false
    skipPartsAndSets: false
    skipSeriesSecondary: false
    # allowedLanguages:
    #   - eng
    #   - deu

  # Root folders for books
  rootFolders:
    - /books
    - /audiobooks

  # Download clients
  downloadClients:
    - name: qbittorrent
      type: qbittorrent
      url: http://qbittorrent.media.svc.cluster.local:8080
      credentialsSecretRef:
        name: qbittorrent-credentials
        usernameKey: username
        passwordKey: password
      category: books-readarr
      priority: 1

    - name: sabnzbd
      type: sabnzbd
      url: http://sabnzbd.media.svc.cluster.local:8080
      apiKeySecretRef:
        name: sabnzbd-credentials
        key: apiKey
      category: books
      priority: 2

  # Remote path mappings
  remotePathMappings:
    - host: qbittorrent.media.svc.cluster.local
      remotePath: /downloads/
      localPath: /data/downloads/

  # Indexers configuration - use Prowlarr (recommended)
  indexers:
    prowlarrRef:
      name: prowlarrconfig-sample
      autoRegister: true

  # File/folder naming
  naming:
    preset: standard
    # Or custom format:
    # authorFolderFormat: "{Author CleanName}"
    # standardBookFormat: "{Book Title} ({Release Year}){[Quality Full]}"
    # colonReplacementFormat: dash

  # Media management settings
  mediaManagement:
    deleteEmptyFolders: true
    createEmptyFolders: false
    minimumFreeSpace: 100

  # Import lists (optional - Goodreads, LazyLibrarian, etc.)
  importLists:
    - name: goodreads-list
      type: goodreads
      listType: bookshelf
      enabled: true
      enableAutomaticAdd: true
      qualityProfileId: 1
      rootFolderPath: /books
      settingsSecretRef:
        name: goodreads-credentials

  # Notifications (optional)
  notifications:
    - name: discord
      type: discord
      onGrab: true
      onDownload: true
      onUpgrade: true
      webhookSecretRef:
        name: discord-webhook
        key: url

  # Reconciliation settings
  reconciliation:
    interval: 5m
    suspend: false
---
# Example secrets (DO NOT use in production - use sealed-secrets or external-secrets)
apiVersion: v1
kind: Secret
metadata:
  name: readarr-credentials
type: Opaque
stringData:
  apiKey: "your-readarr-api-key"
